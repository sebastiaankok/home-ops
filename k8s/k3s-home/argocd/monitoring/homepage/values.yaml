controllers:
  homepage:
    strategy: Recreate
    annotations:
      reloader.stakater.com/search: "true"

    containers:
      app:
        image:
          repository: ghcr.io/gethomepage/homepage
          tag: v1.7.0@sha256:b6ac42c31845ea7c862d71451c16413a6284430d8ff08e16ad791f42718a7c71
        env:
          TZ: Europe/Amsterdam
          LOG_LEVEL: debug
          HOMEPAGE_ALLOWED_HOSTS: "homepage.otohgunga.nl"
        envFrom:
          - secretRef:
              name: homepage-secret
        resources:
          requests:
            cpu: 25m
            memory: 105M
          limits:
            memory: 225M
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
              - ALL
    serviceAccount:
      identifier: homepage

serviceAccount:
  homepage: {}

service:
  app:
    controller: homepage
    ports:
      http:
        port: 3000

ingress:
  app:
    enabled: true
    className: nginx
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-dns
      nginx.ingress.kubernetes.io/proxy-body-size: 32m
    hosts:
      - host: homepage.otohgunga.nl
        paths:
          - path: /
            pathType: Prefix
            service:
              name: homepage
              port: 3000
    tls:
      - hosts:
          - homepage.otohgunga.nl
        secretName: homepage-tls

persistence:
  config:
    type: configMap
    name: homepage-config
    globalMounts:
      - subPath: kubernetes.yaml
        path: /app/config/kubernetes.yaml
      - subPath: docker.yaml
        path: /app/config/docker.yaml
      - subPath: settings.yaml
        path: /app/config/settings.yaml
      - subPath: bookmarks.yaml
        path: /app/config/bookmarks.yaml
      - subPath: services.yaml
        path: /app/config/services.yaml
      - subPath: widgets.yaml
        path: /app/config/widgets.yaml
